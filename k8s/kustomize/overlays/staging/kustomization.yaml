# =============================================================================
# BUTTERFLY Platform - Staging Overlay
# =============================================================================
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

metadata:
  name: butterfly-platform-staging

namespace: butterfly-staging

# Base configuration
resources:
  - ../../base

# Staging-specific patches
patches:
  # Set replica counts to 2
  - target:
      kind: Deployment
    patch: |-
      - op: replace
        path: /spec/replicas
        value: 2

# Staging ConfigMap overrides
configMapGenerator:
  - name: butterfly-platform-config
    behavior: merge
    literals:
      - LOG_LEVEL=INFO
      - BUTTERFLY_REQUIRE_TENANT=false
      - BUTTERFLY_VALIDATE_TENANT=false
      - SPRING_PROFILES_ACTIVE=staging,kubernetes

# Labels specific to staging
commonLabels:
  environment: staging

# Enable chaos mesh annotation for staging
commonAnnotations:
  chaos-mesh.org/enabled: "true"

